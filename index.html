<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>GeoJSON Viewer (Leaflet)</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    html, body, #map { height: 100%; margin: 0; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // Paste YOUR GeoJSON below (replace the object assigned to `data`)
    const data = {
      "type": "FeatureCollection",
      "features": [
        { 
          "type": "Feature", 
          "properties": { 
            "name": "Estimated Camera Position", 
            "category": "reference",
            "note": "(-76.6859, 39.4942)"
          },
          "geometry": { 
            "type": "Point", 
            "coordinates": [ -76.6859, 39.4942 ] 
          }
        },

        { 
          "type": "Feature", 
          "properties": { 
            "name": "Ashland Furnace site", 
            "category": "reference",
            "note": "approximate location based on historical maps (-76.6883, 39.4934)"
          },
          "geometry": { 
            "type": "Point", 
            "coordinates": [ -76.6883, 39.4934 ] 
          }
        },

        { 
          "type": "Feature", 
          "properties": { 
            "name": "Worker housing rows", 
            "category": "housing",
            "note": "approximate location based on historical maps (-76.692461, 39.494568)"
          },
          "geometry": { 
            "type": "Point", 
            "coordinates": [ -76.69246144780539, 39.49456875302705 ] 
          }
        },

        { 
          "type": "Feature", 
          "properties": { 
            "name": "Slag/stone bank (approx.)", 
            "category": "slag" 
          },
          "geometry": { 
            "type": "Point", 
            "coordinates": [ -76.6896, 39.4936 ] 
          }
        },

        { 
          "type": "Feature", 
          "properties": { 
            "name": "View Cone (~35°)", 
            "bearing_to_target_deg": 246.6, 
            "category": "viewcone" 
          },
          "geometry": { 
            "type": "Polygon",
            "coordinates": [[
              [ -76.6859, 39.4942 ],
              [ -76.6929505919094, 39.48949289122057 ],
              [ -76.69517431362617, 39.493464930916545 ],
              [ -76.6859, 39.4942 ]
            ]] }},

        { 
          "type": "Feature", 
          "properties": { 
            "name": "Camera→Target sightline", 
            "category": "reference" 
          },
          "geometry": { 
            "type": "LineString",
            "coordinates": [[ -76.6859, 39.4942 ], [ -76.6883, 39.4934 ]] 
          }
        },

        { 
          "type": "Feature", 
          "properties": { 
            "name": "Approx. NCR Rail Alignment (≈20°)", 
            "bearing_deg": 20.0, 
            "category": "rail" 
          },
          "geometry": { 
            "type": "LineString",
            "coordinates": [[ -76.69228535154822, 39.48494907320139 ], [ -76.68431367943748, 39.50185079071264 ]] 
          }
        },

        { 
          "type": "Feature", 
          "properties": { 
            "name": "Rail Reference – North (≈350 m)", 
            "category": "rail" 
          },
          "geometry": { 
            "type": "Point", 
            "coordinates": [ -76.68690489805466, 39.496357792232985 ] 
          }
        },

        { 
          "type": "Feature", 
          "properties": { 
            "name": "Rail Reference – South (≈450 m)", 
            "category": "rail" 
          },
          "geometry": { 
            "type": "Point", 
            "coordinates": [ -76.69009352808165, 39.48959709977683 ] 
          }
        }
      ]
    }


const map = L.map('map');
const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
  {attribution:'&copy; OpenStreetMap'}).addTo(map);
const sat = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
  {attribution:'Tiles &copy; Esri'});

// Create panes for strict z-order (polygons at back)
map.createPane('polys');   map.getPane('polys').style.zIndex = 200;
map.createPane('lines');   map.getPane('lines').style.zIndex = 250;
map.createPane('points');  map.getPane('points').style.zIndex = 300;

// Split into three layers so polygons don't capture clicks
const polyLayer = L.geoJSON(data, {
  pane: 'polys',
  filter: f => f.geometry.type === 'Polygon',
  style: f => ({ weight: 2, fillOpacity: 0.25 }),
  interactive: false  // <-- prevents the view cone from stealing clicks
}).addTo(map);

const lineLayer = L.geoJSON(data, {
  pane: 'lines',
  filter: f => f.geometry.type === 'LineString',
  style: f => ({ weight: 3 })
}).addTo(map);

// Use pin-drop markers (Leaflet default icon) to make points prominent
const pointLayer = L.geoJSON(data, {
  pane: 'points',
  filter: f => f.geometry.type === 'Point',
  pointToLayer: (f, latlng) => L.marker(latlng, { title: f.properties?.name || '' }),
  onEachFeature: (f, l) => {
    const n = f.properties?.name || 'Feature';
    const note = f.properties?.note ? `<br><em>${f.properties.note}</em>` : '';
    l.bindPopup(`<b>${n}</b>${note}`);
  }
}).addTo(map);

// Optional: add a faint halo under points for even more prominence
const pointHalo = L.geoJSON(data, {
  pane: 'points',
  filter: f => f.geometry.type === 'Point',
  pointToLayer: (f, latlng) =>
    L.circleMarker(latlng, { radius: 10, weight: 2, opacity: 0.6, fillOpacity: 0.15 })
}).addTo(map);

// Layer control
L.control.layers({ 'OpenStreetMap': osm, 'Esri World Imagery': sat },
                 { 'Points': pointLayer, 'Point halos': pointHalo, 'Lines': lineLayer, 'View cone': polyLayer },
                 { collapsed: false }).addTo(map);

// Fit to everything
const all = L.featureGroup([polyLayer, lineLayer, pointLayer]);
map.fitBounds(all.getBounds(), { padding: [20,20] });
</script>
</body>
</html>